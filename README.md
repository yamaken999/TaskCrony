# TaskCrony

Windows用タスクスケジューラー自動化ツール

## 概要

TaskCronyは、週次定例会などで日付つきのフォルダを作成したり、進捗資料のファイルに日付を付与してコピー作成する機会が多い方のために作られた自動化ツールです。

## 主な機能

- **BATファイル自動生成**: 指定した条件に基づいてバッチファイルを自動生成
- **Windowsタスクスケジューラー連携**: 生成したBATファイルをタスクスケジューラーに自動登録
- **フォルダ自動作成**: 日付ベースの命名規則でフォルダを自動作成
- **ファイル自動コピー**: 指定したファイルを日付付きファイル名でコピー
- **柔軟な命名設定**: 接頭語・接尾語・日付オフセットの指定が可能
- **日付位置の自由設定**: 接頭語・接尾語と日付の位置関係を柔軟に指定
- **リアルタイムプレビュー**: ファイル名の生成結果を即座に確認
- **タスク管理**: 登録済みタスクの一覧表示・編集・削除機能

## システム要件

- Windows 10/11
- .NET 8.0 Runtime
- 管理者権限（タスクスケジューラーへの書き込みに必要）

## インストール

1. リリースページから最新版をダウンロード
2. 適当なフォルダに展開
3. `TaskCrony.exe` を実行

## 使用方法

### 1. タスク作成

1. **作成オプション**でフォルダ作成・ファイルコピーを選択
2. ファイルコピーを選択した場合は、**ファイルパス設定**でコピー元とコピー先を指定
3. **ファイル名設定**で接頭語・接尾語・日付オフセットを設定
4. **スケジュール設定**でタスク名・実行スケジュールを設定
5. **タスク作成・登録**ボタンをクリック

### 2. タスク管理

- **タスク管理**タブで登録済みタスクの確認・編集・削除が可能
- **更新**ボタンでタスク一覧を最新状態に更新
- **編集**ボタンで選択したタスクの設定を変更
- **削除**ボタンで選択したタスクを削除

#### タスク編集機能
- 既存タスクの全設定項目を編集可能
- タスク名、スケジュール、ファイルパス、命名規則の変更
- BATファイルの内容を自動解析して現在の設定を復元
- 複雑なファイル名パターンにも対応（接頭語・接尾語・日付の組み合わせ）
- 編集内容に基づいて新しいBATファイルを生成

## ファイル名の命名規則

### 柔軟な日付位置指定

v1.1.0から、接頭語・接尾語と日付の位置関係を自由に設定できるようになりました：

#### 接頭語の日付位置
- **日付＋接頭語**: `20250115prefix_filename.txt`
- **接頭語＋日付**: `prefix20250115_filename.txt`
- **接頭語のみ**: `prefix_filename.txt`

#### 接尾語の日付位置
- **日付＋接尾語**: `filename_20250115suffix.txt`
- **接尾語＋日付**: `filename_suffix20250115.txt`
- **接尾語のみ**: `filename_suffix.txt`

### リアルタイムプレビュー

設定変更時に生成されるファイル名をプレビューで即座に確認できます。

### 設定例
- 接頭語: "Weekly_" （接頭語＋日付を選択）
- 接尾語: "_Report" （接尾語＋日付を選択）
- 日付オフセット: 0（実行日当日）
- 実行日: 2025年1月15日
- 結果: `Weekly_20250115OriginalFileName_Report20250115.xlsx`

### 従来形式
- 基本形: `[接頭語][日付][ベースファイル名][日付][接尾語]`
- 日付形式: YYYYMMDD
- 日付オフセット: 実行日を基準とした日数の加減算

## 技術仕様

- 開発言語: C# (.NET 8.0)
- UIフレームワーク: Windows Forms
- タスクスケジューラーライブラリ: TaskScheduler 2.11.0
- BATファイル保存場所: 実行ファイルと同じディレクトリの`BAT`フォルダ
- エンコーディング: UTF-8（日本語ファイル名対応）

### BATファイルについて

- **保存場所**: `TaskCrony.exe`と同じフォルダ内の`BAT`サブフォルダ
- **自動生成**: BATフォルダが存在しない場合は自動的に作成されます
- **命名規則**: `{タスク名}_{作成日時YYYYMMDDHHMMSS}.bat`
- **文字エンコーディング**: UTF-8（日本語対応）
- **実行**: Windowsタスクスケジューラーから自動実行されます

例: `C:\Program Files\TaskCrony\BAT\週次レポート_20250717095638.bat`

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## サポート

問題や要望がありましたら、GitHubのIssuesページでお知らせください。

## 更新履歴

### v1.1.0 (2025-07-17)
- **NEW**: 柔軟な日付位置指定機能
  - 接頭語・接尾語と日付の位置関係を自由に設定可能
  - 「日付＋接頭語」「接頭語＋日付」オプション追加
  - 「日付＋接尾語」「接尾語＋日付」オプション追加
- **NEW**: リアルタイムプレビュー機能
  - ファイル名の生成結果を即座に確認
  - 設定変更時の自動更新
  - タスク編集画面にもプレビュー機能を追加
- **NEW**: タスクスケジューラ直接起動機能
  - タスク管理タブから Windows タスクスケジューラを直接起動
  - より詳細な設定変更や確認が可能
- **IMPROVED**: UIレイアウトの改善
  - プレビューとスケジュール設定の重複解消
  - 読み取り専用プレビューの視覚的改善
  - 日付位置指定をラジオボタンに変更（排他的選択を明確化）
- **IMPROVED**: BATファイル管理の最適化
  - 同一タスク名の古いBATファイルを自動削除
  - ディスク容量の効率的使用

### v1.0.0 (2025-07-17)
- 初回リリース
- 基本機能の実装
- Shift_JISエンコーディングエラーの修正
- UTF-8エンコーディング対応（日本語ファイル名サポート強化）
- タスク編集機能の追加
- 既存タスクの設定内容復元・修正機能
- 複雑なファイル名パターンの解析機能強化
