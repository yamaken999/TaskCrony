# TaskCrony v1.1.0

**Windows Task Scheduler Automation Tool**

週次定例会や定期的の**準備**などにファイル・フォルダ作成作業を自動化するWindowsアプリケーションです。
日付付きフォルダの作成やファイルの自動コピーをタスクスケジューラーと連携して実行できます。

## 🚀 主な機能

### 📁 自動フォルダ作成
- 日付を含む命名規則でフォルダを自動作成
- 接頭語・接尾語の柔軟な配置
- 日付オフセット機能（実行日±最大365日）

### 📄 自動ファイルコピー
- 複数ファイルの一括コピー
- 日付付きファイル名での自動リネーム（実行日基準）
- 文字列置換機能

### ⏰ スケジュール実行
- Windowsタスクスケジューラーとの連携
- 今すぐ実行・毎日・毎週・毎月の定期実行
- BATファイル生成による軽量実行

### 🎯 タスク管理
- 作成済みタスクの一覧表示
- タスクの編集・削除・実行
- ステータス確認

## 🖥️ システム要件

- **OS**: Windows 10 / Windows 11
- **.NET**: .NET 8.0 Runtime
- **権限**: 管理者権限（タスクスケジューラー操作時）

## 📋 使用方法

### 1. タスク作成

#### 基本設定
- **タスク名**: スケジューラーに登録するタスク名
- **機能選択**: ファイルコピー・フォルダ作成を個別または同時選択

#### ファイルパス設定
- **コピー元**: 対象ファイルのパス（複数選択可能、`;`区切り）
- **作成先**: フォルダ作成・ファイルコピー先のパス

#### ファイル名設定
- **接頭語/接尾語**: ファイル名に付加する文字列
- **日付位置**: 以下のパターンから選択
  - `日付+接頭語`: `20250723prefix_filename.txt`
  - `接頭語+日付`: `prefix20250723_filename.txt`
  - `なし`: `prefix_filename.txt`

#### フォルダ名設定
- **ベース名**: フォルダの基本名（デフォルト: "Folder"）
- **接頭語/接尾語**: フォルダ名に付加する文字列
- **日付位置**: ファイル名設定と同様の柔軟な配置

#### 共通設定
- **日付オフセット**: 実行日からの日数オフセット（-365～365日）
  - `0`: 実行日当日の日付
  - `+1`: 実行日の翌日の日付
  - `-1`: 実行日の前日の日付
  - 例: 毎日実行で前日のログをバックアップする場合は`-1`を設定
- **プレビュー**: 作成されるファイル名・フォルダ名の事前確認（実行日基準で表示）

#### スケジュール設定
- **実行頻度**: 今すぐ実行・毎日・毎週・毎月
- **開始日時**: 定期実行の開始日時設定

### 2. タスク管理

- **一覧表示**: 登録済みタスクの状態確認
- **編集**: 既存タスクの設定変更
- **実行**: 手動でのタスク実行
- **削除**: 不要なタスクの削除

## 🎨 画面構成

### メイン画面（タブ形式）

#### タスク作成タブ
```
┌─ 基本設定 ──────────────┐  ┌─ スケジュール設定 ────┐
│ タスク名: [___________] │  │ 実行頻度: [今すぐ実行▼]│
│ ☑ファイルコピー         │  │ 開始日時: [yyyy/mm/dd] │
│ ☑フォルダ作成          │  └─────────────────────┘
└──────────────────────┘

┌─ ファイルパス設定 ─────────────────────────────────┐
│ コピー元: [________________________] [参照...]     │
│ 作成先:   [________________________] [参照...]     │
└─────────────────────────────────────────────────┘

┌─ ファイル名設定 ──────────────────────────────────┐
│ 接頭語: [____]  接尾語: [____]                    │
│                                                   │
│ ┌─ 接頭語日付位置 ────────────────────────────────┐│
│ │ ○日付+接頭語  ○接頭語+日付  ●なし              ││
│ └───────────────────────────────────────────────┘│
│                                                   │
│ ┌─ 接尾語日付位置 ────────────────────────────────┐│
│ │ ○日付+接尾語  ○接尾語+日付  ●なし              ││
│ └───────────────────────────────────────────────┘│
│                                                   │
│ ┌─ 文字列置換 ────────────────────────────────────┐│
│ │ 置換前: [____]  置換後: [____]                  ││
│ └───────────────────────────────────────────────┘│
└─────────────────────────────────────────────────┘

┌─ フォルダ名設定 ──────────────────────────────────┐
│ ベース名: [Folder]  接頭語: [____]  接尾語: [____] │
│                                                   │
│ ┌─ 接頭語日付位置 ────────────────────────────────┐│
│ │ ○日付+接頭語  ○接頭語+日付  ●なし              ││
│ └───────────────────────────────────────────────┘│
│                                                   │
│ ┌─ 接尾語日付位置 ────────────────────────────────┐│
│ │ ○日付+接尾語  ○接尾語+日付  ●なし              ││
│ └───────────────────────────────────────────────┘│
└─────────────────────────────────────────────────┘

┌─ 共通設定・プレビュー ────────────────────────────┐
│ 日付オフセット: [0] 日  ← 実行日からの日数差分      │
│ プレビュー: [実行日基準でのファイル・フォルダ名表示] │
└─────────────────────────────────────────────────┘

    [タスク作成]  [入力内容をクリア]
```

#### タスク管理タブ
```
┌─ 登録済みタスク一覧 ──────────────────────────────┐
│ タスク名        │ステータス│次回実行    │最終実行  │
│ ─────────────────────────────────────────────────│
│ 週次資料準備    │ 有効     │2025/07/24  │2025/07/17│
│ 月次レポート    │ 無効     │-           │2025/07/01│
└─────────────────────────────────────────────────┘

    [更新] [編集] [実行] [削除] [タスクスケジューラ起動]
```

## 💡 実行例

### 例1: 週次定例会の資料フォルダ作成
- **タスク名**: "週次定例会準備"
- **フォルダ作成**: 有効
- **フォルダベース名**: "WeeklyMeeting"
- **接頭語**: "2025年第"
- **接尾語**: "週"
- **接頭語日付位置**: "接頭語+日付"
- **日付オフセット**: 0日（実行日当日）
- **実行結果**: `2025年第{実行日YYYYMMDD}週_WeeklyMeeting`
- **例**: 2025/07/23実行時 → `2025年第20250723週_WeeklyMeeting`

### 例2: 進捗資料の日付付きコピー
- **タスク名**: "進捗資料更新"
- **ファイルコピー**: 有効
- **コピー元**: `C:\Work\template.xlsx`
- **接頭語**: "進捗_"
- **接頭語日付位置**: "接頭語+日付"
- **日付オフセット**: 0日（実行日当日）
- **実行結果**: `進捗_{実行日YYYYMMDD}_template.xlsx`
- **例**: 2025/07/23実行時 → `進捗_20250723_template.xlsx`

### 例3: 前日のログバックアップ
- **タスク名**: "前日ログバックアップ"
- **ファイルコピー**: 有効
- **コピー元**: `C:\Logs\system.log`
- **接頭語**: "backup_"
- **接頭語日付位置**: "接頭語+日付"
- **日付オフセット**: -1日（前日）
- **実行結果**: `backup_{前日YYYYMMDD}_system.log`
- **例**: 2025/07/23実行時 → `backup_20250722_system.log`

## 🔧 技術仕様

### アーキテクチャ
- **フレームワーク**: .NET 8.0 Windows Forms
- **言語**: C# 12.0
- **UI**: タブベースインターフェース
- **設定**: WinForms Designer による視覚的レイアウト

### 主要クラス
- `MainForm`: メインUIコントローラー
- `TaskEditForm`: タスク編集ダイアログ
- `ModernTheme`: UI テーマ管理

### ファイル構成
```
TaskCrony/
├── MainForm.cs              # メインフォーム（タブUI）
├── MainForm.Designer.cs     # メインフォームレイアウト
├── TaskEditForm.cs          # タスク編集フォーム
├── TaskEditForm.Designer.cs # タスク編集レイアウト
├── ModernTheme.cs           # UIテーマ定義
├── Program.cs               # エントリーポイント
└── TaskCrony.csproj        # プロジェクト設定
```

### BATファイル生成
実行時に以下の構造のBATファイルを生成：
```batch
@echo off
setlocal enabledelayedexpansion

:: 実行日からオフセットを適用した日付を動的に計算
powershell -command "$date = (Get-Date).AddDays([offset]); $date.ToString('yyyyMMdd')" > temp_date.txt
set /p DATE_STRING=<temp_date.txt
del temp_date.txt

:: ファイル名構築関数
call :build_filename "[base]" "[prefix]" "[suffix]" "[prefix_pos]" "[suffix_pos]"

:: フォルダ作成
mkdir "%DESTINATION%\%FOLDER_NAME%"

:: ファイルコピー
copy "%SOURCE%" "%DESTINATION%\%FOLDER_NAME%\%FILE_NAME%"
```

## 🎯 開発のポイント

### UI最適化
- **垂直レイアウト**: ファイル名・フォルダ名設定の縦配置でスペース効率化
- **ラジオボタン**: 排他的選択による操作ミス防止
- **リアルタイムプレビュー**: 設定変更の即座な反映
- **日本語対応**: 文字切れ防止のための充分な幅確保

### ユーザビリティ
- **入力クリア機能**: ワンクリックでの設定リセット
- **タスク管理**: 直感的なタスク一覧と操作ボタン
- **エラーハンドリング**: 適切なバリデーションとエラー表示

### 拡張性
- **モジュラー設計**: 機能ごとの独立したメソッド構成
- **設定の永続化**: 将来的な設定保存機能への対応準備
- **プラグイン対応**: カスタム命名規則の追加可能性

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 コントリビューション

プルリクエストやIssueの報告を歓迎します。

---

**TaskCrony v1.1.0** - より効率的なファイル管理をあなたに
